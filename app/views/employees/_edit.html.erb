<!-- Sec --> 
<div id="employeeEditFormID"  class="employee-form-cls" style="margin-left: 0px; overflow: hidden;" >
  <div class="box">
      
  <%= form_for :employee, url: employee_path(@employee),method: :patch,  :html => {
                            :id => 'elm_id', :class => 'elm_class',
                            :style => 'elm_style' } do |f| %>

        <%= hidden_field_tag 'employee_id' , @employee.id, :id=>"currentEmployeeId"%>


        <%= f.hidden_field :is_employee, :value => "employee" ,:id=>"employeeTypeId"%>

        <div class="form-content" style=" width:100%; border:0px #fac94a solid; color:#000; ">
          <div class="form-content-inner" style="padding:5px;">
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="mg-table-pop-up-mod">
              <tbody>
                <tr>
                  <td valign="top" class="mg-td-width-half">
                    <label class="mg-label" for="employee_number"><%= t('employeenumber') %></label>
                  
                    <%= f.text_field :employee_number, :readonly => "readonly", :class=>"textboxwidth mg-phn-text-field"%>
                  </td>
                  <td valign="top" class="mg-td-width-half">
                    <label class="mg-label" for="joining_date"><%= t('joiningdate') %>
             <span class="required-field">&nbsp;*</span>          
          </label>
                  
                    <%= f.text_field :joining_date, :class=>"textboxwidth employee-joining-date-picker mg-phn-text-field" %>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="form-content">
          <div class="form-content-inner">
            <h4 class="mg-h4"><%= t('generaldetails') %></h4>
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
              <tbody>
                <tr>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="first_name" ><%= t('firstname') %>
                      <span class="required-field">&nbsp;*</span> 
                    </label>
                  </td>

                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="middle_name"><%= t('middlename') %></label>
                  </td>
                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="last_name"><%= t('lastname') %>
                    <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                </tr> 
                <tr>
                  <td valign="top">
                    <%= f.text_field :first_name  %>
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.text_field :middle_name %>
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.text_field :last_name %>
                  </td>
                </tr>

              
               <tr>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="gender"> <%= t('gender') %>
                      <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>

                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label mg-rm-text-trans" for="date_of_birth"><%= t('dateofbirth') %>
                      <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="employee_category"><%= t('employeecategory') %>
                       <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                </tr>
                <tr> 
                  <td valign="top">
                  
                     <%= f.select :gender, options_for_select([[t("select"), ""], [t("male"), "male"], [t("female"), "female"]],:selected => @employee[:gender])%>
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.text_field :date_of_birth, :class=>"textboxwidth" %>
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.collection_select(:mg_employee_category_id,MgEmployeeCategory.all, :id, :category_name,{:include_blank => t("select")},:onchange => "employeeCategorySelect()",:id => "employeeCategorySelectID",:selected => @employee[:mg_employee_category_id])%>
                  </td>
                </tr>

                <tr>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="employee_position"><%= t('employee_profile') %><span class="required-field">&nbsp;*</span></label>
                  </td>

                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="employee_department"><%= t('employeedepartment') %><span class="required-field">&nbsp;*</span></label>
                  </td>
                  <td> </td>
                 
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="job_title"><%= t('jobtitle') %></label>
                  </td>
                </tr>
                <tr>
                  <td valign="top">
                      <%= f.collection_select(:mg_employee_position_id,MgEmployeePosition.all, :id, :position_name,{:include_blank => t("select")})%>
                  </td>
                  <td> </td>
                  <td valign="top">
                     <%= f.collection_select(:mg_employee_department_id,MgEmployeeDepartment.where(:is_deleted => '0', :mg_school_id=>session[:current_user_school_id]), :id, :department_name,{:include_blank => t("select")})%>
                  </td>
                  <td> </td>
                  <td valign="top">
                     <%= f.text_field :job_title, :class=>"textboxwidth" %>
                    
                  </td>
                </tr>

                <tr>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="qualification"><%= t('qualification') %></label>
                  </td>

                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="experience_year"><%= t('experienceyear') %>
                      <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="experience_month"><%= t('experiencemonth') %>
                    <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                </tr>
                <tr>
                  <td valign="top">
                     <%= f.text_field :qualification, :class=>"textboxwidth" %>
                     
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.text_field :experience_year, :class=>"textboxwidth" %>
                  </td>
                  <td> </td>
                  <td valign="top">
                    <%= f.text_field :experience_month, :class=>"textboxwidth" %>
                  </td>
                </tr>
<tr>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="status"><%= t('employeetype') %>
                    <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>

                  <td> </td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="Language"><%= t('languages') %>
                    <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                 <td></td>
                  <td width="33%" valign="bottom">
                   <div id="isdeletedlabel" class="is_deleted" style="display: none;">
                   <label class="mg-label" for="status "><%= t 'status' %>
                  </div>
                  </label>

                  <label class="mg-label" for="ltc"><%= t('ltc_applicable') %>
                    <span class="required-field"></span>
                  </label>

                  </td>
                  <td> </td>
                  <td width="33%" valign="bottom">
                    
                  </td>
                </tr>
                <tr>
                <td valign="top">
    <%@employeetype=MgEmployeeType.where(:is_deleted=>0,:mg_school_id=>session[:current_user_school_id]).pluck(:employee_type,:id)%>
    <%=f.select :mg_employee_type_id,options_for_select(@employeetype,:selected=>@employee.mg_employee_type_id),:prompt=>t('select')%>
    </td> 
    <td></td>
  
                <td valign="top">
                     <%= f.text_field :language, :class=>"textboxwidth mg-text-field" %>
                    <%#= select_tag 'locale', options_for_select([['English','en'],['Spanish','es'],['Hindi','hi'],['Germen','de']], I18n.locale.to_sym),:onchange => 'this.form.submit()'%>
                  </td>
                  <td> </td>
                  <td valign="top">

                  <%= f.check_box :is_ltc_applicable  %>
                   
                  </td>
                  <td></td>
                  <td valign="top" >
              

                <!--   <div id="isdeleted" class="is_deleted" style="display: none;">
                  <%#= f.label :status, t("active"), :value => "true",:class=>"mg-label-inner-form"  %>
                  <%#= f.radio_button :status, false , :checked => true %>
                  <%#= f.label :status, t("inactive"), :value => "false",:class=>"mg-label-inner-form" %>
                    <%#= f.radio_button :status, true %>
                    </div> -->


                  </td>
                </tr>
                 <tr>
                <% if @employee.mg_user.user_type=="employee" %>
                 <%
                    if @employee.mg_employee_category_id.to_s=="1" 
                      max_class_exist=false
                    else
                      max_class_exist=true
                    end
                 %>
                
                   <td width="33%" valign="bottom">
                    <label class="mg-label" for="max_no_of_class"><%= t('max_class_per_day') %>
                      <span class="required-field">&nbsp;*</span>
                    </label>
                  </td>
                  <td></td>
                   <% end %>

                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="mg_employee_grade_id"><%= t('employee_grade') %>
                      <span class="required-field">*</span>
                    </label>
                   </td>
                   <td></td>
                   <td width="33%" valign="bottom">
                    <label class="mg-label" for="mg_employee_grade_id"><%= t('last_working_day') %>
                      <span class="required-field"></span>
                    </label>
                   </td>

                </tr>
                <tr>
                   <% if @employee.mg_user.user_type=="employee" %>
                 <%
                    if @employee.mg_employee_category_id.to_s=="1" 
                      max_class_exist=false
                    else
                      max_class_exist=true
                    end
                 %>
                  <td width="33%" valign="top">
                   <%= f.text_field :max_no_of_class, :id=>"maxNoOfClassTextId", :class=>"textboxwidth mg-text-field", :readonly => max_class_exist  %>
                  </td>
                  <td></td>
                  <%end%>
                   <td width="33%" valign="top">
                   <%@employee_grade=MgEmployeeGrade.where(:is_deleted=>0, :mg_school_id=>session[:current_user_school_id]).pluck(:grade_name,:id)%>
                    <%=f.select :mg_employee_grade_id,options_for_select(@employee_grade,:selected =>@employee.mg_employee_grade_id),:prompt=> t('select')%>
                  </td>

                    <td></td>
                  <td width="33%" valign="top">
                    <%= f.text_field :last_working_day %>
                  </td>
                </tr>
              

                <tr>
                 <td width="33%" valign="bottom">
                      <label class="mg-label" for="school"><%= t('status') %>
                        <span class="required-field">*</span>
                      </label>
                  </td>
                  <td></td>
                  <td width="33%" valign="bottom">
                    <label class="mg-label" for="school"><%#= t('last_working_day') %>
                    </label>
                  </td>
                  <td></td>
              </tr>
              <tr>
                  <td width="33%" valign="top">
                          <%=f.select :status,options_for_select([["Woking", "woking"], ["Retired", "retired"], ["Left", "left"]], :selected=>@employee.status),:prompt=> t('select')%>
                  </td>
                  <td></td>
                   <td width="33%" valign="top">
                      <%#=f.text_field :last_working_day%>
                  </td>
              </tr>
                <%if session[:user_type]=='cloudadmin'%>
                  <% if @employee.mg_user.user_type=="superprincipal" || @employee.mg_user.user_type=="admin"  || @employee.mg_user.user_type=="principal"%>

                     <tr id="schoolNameLabelTRForCloudAdminId" >
                       <td width="33%" valign="bottom">
                        <label class="mg-label" for="school"><%= t('school') %>
                          <span class="required-field">&nbsp;*</span>
                        </label>
                       </td>
                    </tr>

                    <tr id="schoolSelectTRForCloudAdminId" >
                       <td width="33%" valign="top">
                        <% if @schoolList.present?%>
                          <%=f.select :mg_school_id,options_for_select(@schoolList ,:selected => @employee[:mg_school_id] ),:prompt=> t('select')%>
                        <%else%>
                          <%=f.select :mg_school_id,options_for_select(''),:prompt=> t('select')%>
                        <%end%>
                       </td>
                    </tr>

                  <% end%>
                <%end%>

              </tbody>
            </table>
          </div>
      </div>

     
      <%= render :partial => "employees/account_details" %> 

      <%=hidden_field_tag :previous_employee_grade_id, @employee.mg_employee_grade_id%>
      
    <div class="form-content">
        <div class="form-content-inner">
        <h4 class="mg-h4"><%= t("personaldetails") %></h4>
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
                <tbody>
                    <tr>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="marital_status" ><%= t("maritalstatus") %>
                        
                        </label>
                      </td>

                      <td> </td>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="mother_name" ><%= t("mothername") %>
                          <span class="required-field">&nbsp;*</span> 
                        </label>
                      </td>
                     
                      <td> </td>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="father_name"><%= t("fathername") %>
                        <span class="required-field">&nbsp;*</span>
                        </label>
                      </td>
                    </tr> 
                    <tr>
                      <td valign="top">
                       <%= f.select :marital_status, options_for_select([[t("select"), ""], [t("single"), "single"], [t("married"), "married"], [t("Divorced"), "Divorced"], [t("widowed"), "widowed"]],:selected => @employee[:marital_status])%>
                      </td>
                      <td> </td>
                       <td valign="top">
                        <%= f.text_field :mother_name, :class=>"textboxwidth" %>
                      </td>
                    
                      <td> </td>
                      <td valign="top">
                        <%= f.text_field :father_name, :class=>"textboxwidth" %>
                      </td>
                    </tr>
                    
                     <tr>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="blood_group" ><%= t('bloodgroup') %>
                          
                        </label>
                      </td>

                      <td> </td>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="mg_nationality_id" ><%= t('nationality') %>
                        <span class="required-field">&nbsp;*</span>
                          
                        </label>
                      </td>
                    
                      <td> </td>
                    </tr> 
                    <tr>
                      <td valign="top">
                       <%= f.select :blood_group, options_for_select([[t("select"), ""], ["A+"], ["A-"], ["B+"], ["B-"], ["O+"], ["O-"], ["AB+"], ["AB-"]],:selected => @employee[:blood_group])%>
                      </td>
                      <td> </td>
                       <td valign="top">
                       <!--  <#%= f.select :mg_nationality_id, options_for_select([[t("select"), ""], ["India", "2"], ["Sri Lanka", "3"]],:selected => @employee[:mg_nationality_id])%> -->
                        <%= f.country_select :nationality, ["India"], {}, { :class => "form-control" } %>
                      </td>
                    
                    
                      <td> </td>
                     
                    </tr>

                    
                 </tbody>
            </table>
        </div>
      </div>

<!-- Language part has been done below -->
          <h4 class="mg-h4"><%= t('languages_known') %></h4>
          <div id="languageEditPlusId" class="mg-custom-form-btn mg-custom-labels" style="width: 6.5em; cursor: pointer;"><%= t('add_new') %></div>
          <div id="languagedivcloneid" class= "languagedivcloneclass">
                <%#= render :partial => "students/language_known" %> 
                <!-- 
                      step -1 -> Make each loop for existing language
                      step -2 -> make clone of child one in below div 
                --> 
                <% if(@languageList.length > 0)  %>
                  <% @languageList.each do |language| %>
                    <%= render partial: 'employees/language_known', locals: {language: language} %>
                  <% end %>
                <%else %>
                  <%= render partial: 'employees/language_known_clone' %>
                <% end %>
          </div>

          <div id="languagedivscloneid" class= "languagedivscloneclass mg-btn-bottom-margin">
                        
          </div>
        <!-- Language part has been done above -->


      <h4 class="mg-h4"><b><%=t('photo')%></b></h4>
      <table>
        <tr>
            <td width="35%">
              <label class="mg-custom-labels mg-label"  for="schoollogo "><%= t 'PhotoUpload' %><span class="required-field">&nbsp;*</span></label><br/>
              <%= image_tag  @employee.photo.url(:medium, timestamp: false),:class => 'mg-img-size mg-btn-bottom-margin mg-custom-labels',:id=>"employeeImageTagID"  %>
              </td>
              <td>
              <%= f.file_field :photo,:onchange =>"validateEmployeeImage(this.value,this);"%>
              <%#= file_field 'user_pic', accept: 'image/png,image/gif,image/jpeg'%>
              <%#= @school.logo_file_name %>
            </td>
          </tr>
      </table>


      <%
        is_referred=@employee.is_referred
        if(is_referred==true)
          display="block"
        else
           display="none"
         end
          
      %>


      <h4 class="mg-h4"><%=t('referred')%></h4>
      <div id="empREferredDivId" class= "emp-referred-div-cls">   
          <table width="100%" cellspacing="0" cellpadding="0" border="0" style="margin-left: 14px;">
            <tbody>
              <tr>
                    <td width="31%" valign="top">
                      <label for="referred"  class="mg-label"><%= t('referred') %>
                        <span class="required-field"></span> 
                      </label>
                    </td>
                    <td valign="top">
                     <%= f.check_box :is_referred ,{:id=>"employeeReferredCheckBoxId",:class=>"emp-referred-checkbox-cls"}, true %>
                    </td>
              </tr>
            </tbody> 
        </table> 

        <div id="empReferredByDivId" class=" mg-inner-tbl-align" style="display:<%=display%>;">
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls mg-btn-bottom-margin ">
              <tbody>
              <tr>
                <td width="10.5%" valign="top">
                <label class="mg-label" for="referred_by" ><%= t('referred_by') %>
                <span class="required-field">&nbsp;*</span> 
                </label>
                </td>

                <td width="34%" valign="top">
                <label class="mg-label" for="designation" ><%= t("designation") %>
                <span class="required-field"></span> 
                </label>
                </td>
              </tr>

              <tr>
                <td valign="top">
                <%= f.text_field :referred_by  ,:class => ' mg-text-field'%>
                </td>

                <td valign="top">
                <%= f.text_field :designation  ,:class => ' mg-text-field'%>
                </td>
              </tr>
              </tbody>
            </table>
      </div>


      </div>



      <%= render :partial => 'employees/address' , :locals => {:addresstype => "Temporary"}%>
      
      <%=render :partial => 'employees/address' , :locals => {:addresstype => "Permanent"}%>
      
  

      <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
            <tbody>
          <tr>
          <td width="100%" valign="bottom">
              </td>
              <td width="100%" valign="bottom">
              </td>
          </tr>
          <h4 class="mg-h4"><%= t('contacts') %></h4>
          <tr>
              <td valign="top">
                   <%= render :partial => "employees/contact_emergency" ,:locals => {:phone_types => "phone"} %>
              </td>
              </tr>
              <tr>
                <td valign="top">
                   <%= render :partial => "employees/contact" ,:locals => {:phone_types => "mobile"} %>
                </td>

            </tr>
            </tbody>
            </table>

            <%= render "employees/email" %>
            
            <h4 class="mg-h4"><%= t('emergencycontacts') %></h4>
            <div class="form-content">
        <div class="form-content-inner">
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
                <tbody>
                    <tr>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="emergency_contact_name" ><%= t('contactname') %>
                          <span class="required-field">&nbsp;*</span> 
                        </label>
                      </td>

                      <td> </td>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="emergency_contact_number" ><%= t("contactnumber") %>
                          <span class="required-field">&nbsp;*</span> 
                        </label>
                      </td>
                     
                      <td> </td>
                      <td width="33%" valign="bottom">
                        <span class="required-field"></span>
                        </label>
                      </td>
                    </tr> 
                    <tr>
                      <td valign="top">
                        <%= f.text_field :emergency_contact_name, :class=>"textboxwidth" %>
                      </td>
                      <td> </td>
                       <td valign="top">
                         +91-<%= f.text_field :emergency_contact_number, :class=>"textboxwidth textboxwidth mg-phn-text-field valid"%>
                      </td>
                    
                      <td> </td>
                      <td valign="top">
                       
                      </td>
                    </tr>
                    </tbody>
                    </table>
                    </div>
                    </div>

          <!-- 
############################################################################################

 -->

<h4 class="mg-h4"><%= t('activities') %></h4>
            <div class="form-content">
        <div class="form-content-inner">
            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
                <tbody>
                    <tr>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="sport_activity" ><%= t('sport_activity') %>
                        </label>
                      </td>
                    </tr>
                    <tr>
                        <td valign="top" colspan="3">
                        <%= f.text_area :sport_activity, :rows=>"5", :cols=>"70", :maxlength=>"4000", :class=>"textboxwidths mg-text-fields" %>
                        </td>
                        <tr>
                        <td>
                        <%@document=MgDocumentManagement.where(:mg_user_id=>@employee.mg_user_id,:document_type=>"SportsActivity")%>
                          <%@document.each_with_index do |user,i|%>
                              <li data-index="<%= i %>" style="list-style: none;">
                              <div delete-index="<%= i %>">
                                  <label class="mg-file-clr mg-label-inner-form"><%= user.file_file_name %></label>
                                 <a class="delete-operation mg-icon-btn" style="cursor: pointer; text-decoration: none; color: #363131; font-size: 0.8em;" id="<%=user.id %>" title="Delete"><i class="fa fa-trash"></i></a>
                              </div>
                             </li>
                         <%end%>
                      </td>
                      </tr>
                      </tr>
                      <tr>
              <%= form_for :document_managements, url: document_managements_path, :html => {:id => 'documentManagementsFormID' } do |f| %>
                        <td>
                          <label class="mg-label mg-rm-text-trans" for="upload_file" ><%= t('upload_file') %></label>
                          <div >
   <div class="employees_edits-file-file-div" id="dueFineDivId"style="float: left; width: 100%;">
   <span style="float: left;">
 <%= file_field_tag 'file[]'%>
</span>
  <a href="#" class="emps-edits-remove-file mg-custom-form-btn mg-icon-btn" style="color: #297ACC; font-size:0.8em; float: left; position: relative; right: 0px; margin-top: 3px;"><i class="fa fa-trash"></i>
</a>
 </div>
 <a href="#" id="emps_edit_file" class="mg-label-inner-form mg-custom-form-btn mg-icon-btn" style="color: #297ACC; font-size:0.8em;" ><i class="fa fa-plus">&nbsp;<%=t('add_file')%></i>
</a>  <br/>
  </div>
 

                        </td>
                      </tr>
                <% end %>
                    </tbody>
            </table>
        
      
                  <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
                <tbody>
                    <tr>
                      <td width="33%" valign="bottom">
                        <label class="mg-label" for="extra_curricular" ><%= t("extra_curricular") %>
                        </label>
                      </td>
                    </tr>
                      <tr>
                      <td valign="top">
                         <%= f.text_area :extra_curricular, :rows=>"5", :cols=>"70", :maxlength=>"4000", :class=>"textboxwidths mg-text-fields" %>
                      </td>
                      <tr>
                        <td>
                          <%@document=MgDocumentManagement.where(:mg_user_id=>@employee.mg_user_id,:document_type=>"ExtraCurricular")%>
                          <%@document.each_with_index do |user,i|%>
                            <li data-index="<%= i %>" style="list-style: none;">
                            <div delete-index="<%= i %>">
                                <label class="mg-file-clr mg-label-inner-form"><%= user.file_file_name %></label>
                                <a class="delete-operation mg-icon-btn" style="cursor: pointer; text-decoration: none; color: #363131; font-size: 0.8em;" id="<%=user.id %>" title="Delete"><i class="fa fa-trash"></i></a>
                           </div>
                           </li> 
                          <%end%>
                        </td>
                      </tr>
                      </tr>
                      <tr>
                        <td>
                          <label class="mg-label mg-rm-text-trans" for="upload_file" ><%= t('upload_file') %></label>
                          <div>
    <%files=Array.new()%>
     <div class="emp-edit-files-upload-div" id="dueFineDivId" style="float: left; width: 100%;">
     <span style="float: left;">
    <%= file_field_tag 'files[]' %>
    </span>
   <a href="#" class="emp-edit-removes-files-upload mg-custom-form-btn mg-icon-btn" style="color: #297ACC; font-size:0.8em; float: left; position: relative; right: 0px; margin-top: 3px;"><i class="fa fa-trash"></i></a>
 </div>
 <a href="#" id="employeesditaddfilesuploads" class="mg-label-inner-form mg-custom-form-btn mg-icon-btn" style="color: #297ACC; font-size:0.8em;" ><i class="fa fa-plus">&nbsp;<%=t('add_file')%></i></a> <br/>
</div>
                        </td>
                      </tr>
              </tbody>
              </table>

            <table width="100%" cellspacing="0" cellpadding="0" border="0" class="employee-form-cls">
                <tbody>
                     <tr>
                      <td width="33%" valign="bottom">
                      <label class="mg-label" for="hobby" ><%= t("hobbies") %>
                        <span class="required-field"></span>
                        </label>
                      </td>
                    </tr> 
                    <tr>
                      <td valign="top">
                       <%= f.text_area :hobby, :rows=>"5", :cols=>"70", :maxlength=>"4000", :class=>"textboxwidths mg-text-fields" %>
                      </td>
                    </tr>
                    </tbody>
            </table>
        </div>
      </div>







<!-- ############################################################################################### -->

      <!--custom fields-->
<%if @dbdatas.size>0%>
<h4 class="mg-h4" ><span style="margin-left:4px;"><%=t('customfields')%></span></h4>
              <div class="mg-custom-labels">
               <% @dbdatas.each do |dbdata| %>

              <%custom_data=Array.new%>
            <%= hidden_field_tag 'custom_data[]', dbdata.id%>


              <label class="mg-capitalize-lbl mg-label"><%= dbdata.name%></label><br>

             

             <%

               @customData.each do |custData| 

               if custData.mg_custom_field_id == dbdata.id.to_s
                  @custValue = custData.value
               
               end
             end
              %> 

              <% @data=dbdata.text_data.split(",")
               for i in 0..@data.length-1

                 if dbdata.data_type=="check_box"

                      custom_field=Array.new%>

                      <%= check_box_tag 'custom_field_'+dbdata.id.to_s+'[]', @data[i],
                      if @custValue.nil? then false else @custValue.include?(@data[i]) end
                        %>
                      <%=@data[i] %>
                  <br/>

               <%elsif dbdata.data_type=="radio_button" 
                      custom_field=Array.new%>
                      <%= radio_button_tag 'custom_field_'+dbdata.id.to_s+'[]', @data[i], (@data[i]==@custValue) %>
                       <%=@data[i] %>
                 <br/>


               <%elsif dbdata.data_type=="drop_down" 
                      custom_field=Array.new%>
                      <%= select_tag 'custom_field_'+dbdata.id.to_s+'[]', options_for_select(@data, :selected => @custValue ) ,:class=>"mg-select-btn"%><br/>
                 <%break


                elsif dbdata.data_type=="input_type" 

                    custom_field=Array.new%>

                     <%= text_field_tag 'custom_field_'+dbdata.id.to_s+'[]',@custValue ,:class=>"mg-text-field"%><br/>

                <%end%>

                 <%end%>

                  <%end%>
<%end%>
<input type="submit" id="submitEmployeeFormBtnId" style="display:none"/>

</div>
  
  <br>     
<p>
       <%#= f.submit t('save') ,:class=>"mg-small-form-btn mg-custom-labels"%>
       <%#= f.submit t("save"),:type => 'button',:id=>"clickFormBtnId",:class=>"mg-small-form-btn mg-custom-labels"%>
       <a  id="clickFormEditBtnId" class="mg-custom-labels mg-small-form-btn"><%=t("save")%></a>

      
       <%= link_to t('cancel'), :back, {:class=>"mg-small-form-btn cancel-form-dialog"} %>
   </p>    
        
    <% end %>

  </div>
</div>




<script>



$(document).ready(function () {

dateFormatStr =  getJsDateFormat();
//alert(dateFormatStr);
$('#employee_joining_date').datepicker({ changeMonth: true,
                changeYear: true,yearRange: "-100:+0",maxDate: "0",dateFormat: dateFormatStr});

$('#employee_date_of_birth').datepicker({ changeMonth: true,
                changeYear: true,yearRange: "-100:+0",maxDate: "0",dateFormat: dateFormatStr});
$('#employee_last_working_day').datepicker({ changeMonth: true,
                changeYear: true,yearRange: "-100:+0",maxDate: "0",dateFormat: dateFormatStr});


var joiningDate =  $.datepicker.formatDate(dateFormatStr,new Date($('#employee_joining_date').val()));
var dobDate =  $.datepicker.formatDate(dateFormatStr,new Date($('#employee_date_of_birth').val()));
if($('#employee_last_working_day').val()){
var last_working_day =  $.datepicker.formatDate(dateFormatStr,new Date($('#employee_last_working_day').val()));
}


//alert(joiningDate);
$('#employee_joining_date').val(joiningDate);
$('#employee_date_of_birth').val(dobDate);
$('#employee_last_working_day').val(last_working_day);

$(document).on("change","#employee_last_working_day",function(e){

      var last_working_day=$(this).val();
      var joining_date=$("#employee_joining_date").val();
      if(joining_date){
        if(getDateObj(joining_date,dateFormatStr)>getDateObj(last_working_day,dateFormatStr)){
          alert("Last working day should be greater than joining date");
          document.getElementById('employee_last_working_day').value ="";
        }
      }else{
         alert("Please select joining date");
          document.getElementById('employee_last_working_day').value ="";
      }
        
   });


$("#languagePlusId").click(function(){
        

      var cloneDiv=$(".languagedivcloneclass").first();

       $(cloneDiv).clone().appendTo("#languagedivscloneid");

      var cloneDivLast=$(".languagedivcloneclass").last();
      $(cloneDivLast).children().find('input,checkbox').each(function(){

         $(this).val('');
         $(this).attr("checked",false);
         // neeed to change here
         $(".language-Student-Div-Class").hide();

        });



    });

  $("#employeeReferredCheckBoxId").change(function(){
    if($("#employeeReferredCheckBoxId").is(':checked'))
      $("#empReferredByDivId").show();  // checked
    else
      $("#empReferredByDivId").hide();  // unchecked

  });


    $(function () {
    $.validator.addMethod('dateFormat',
    function (value, element) {
      dateFormatStr =  getJsDateFormat();
        if (this.optional(element)) {
            return true;
        }
        var ok = true;
        try {
            $.datepicker.parseDate(dateFormatStr, value);
        }
        catch (err) {
            ok = false;
        }
        return ok;
    },
      "Please enter a date in the format "+ getDateFormat(dateFormatStr) +".");
      dateFormatStr =  getJsDateFormat();

    $(".datefield").datepicker({ dateFormat: dateFormatStr, changeYear: true });
});





$("#elm_id").validate({

        rules: {
        "employee[first_name]": {required: true, name_validate: true, maxlength: 25},
        "employee[middle_name]": {name_validate: true, maxlength: 25},
        "employee[last_name]": {required: true, name_validate: true, maxlength: 25},
        "employee[gender]": {required: true},
        "employee[date_of_birth]": {dateFormat: true,required: true},
        "employee[mg_employee_department_id]": {required: true},
        "employee[mg_employee_position_id]": {required: true},
        "employee[mg_employee_grade_id]": {required: true},
        "employee[mg_employee_category_id]": {required: true},
        
        "employee[status]": {required: true},
        "employee[job_title]": {character_validate: true, maxlength: 25},
        "employee[experience_year]": {required: true, number: true, max: 50},
        "employee[experience_month]": {required: true, number: true, max: 11},
        "employee[father_name]": {required: true, name_validate: true, maxlength: 35},
        "employee[mother_name]": {required: true, name_validate: true, maxlength: 35},
        "employee[joining_date]": {dateFormat: true,required: true},
        "employee[mg_nationality_id]": {required: true},
        "employee[mg_employee_type_id]":{required: true},
        "employee[language]":{required: true, character_validate: true, maxlength: 25},

        "employee[max_no_of_class]": {required: true, number: true, min: 0},

        "Temporary[address_line1]": {required: true}, 
        "Temporary[city]": {required: true}, 
        "Temporary[state]": {required: true}, 
        "Temporary[pin_code]": {required: true, number: true, minlength: 6,maxlength: 6}, 
        "Temporary[country]": {required: true}, 

        "Permanent[address_line1]": {required: true}, 
        "Permanent[city]": {required: true}, 
        "Permanent[state]": {required: true}, 
        "Permanent[pin_code]": {required: true, number: true, minlength: 6,maxlength: 6}, 
        "Permanent[country]": {required: true}, 
        "employee[emergency_contact_name]": {required: true}, 
        "employee[emergency_contact_number]": {required: true, number: true, minlength: 10,maxlength: 10}, 
        "phone[phone_number]": {number: true,maxlength: 10}, 
        "mobile[phone_number]" :  {required: true, number: true, minlength: 10,maxlength: 10}, 
        "email[mg_email_id]": {required: true,  email: "Your email must be in the format of name@domain.com"},
        "employee[referred_by]": {required: true},
        "employee[pay_scale]": {required: true,number: true, maxlength: 10},
       "employee[pay_scale]": {required: true,number: true, maxlength: 10},
         "account_details[bank_name]": {required: true, name_validate: true},
        "account_details[ifs_code]": {required: true, maxlength: 20, ifs_validate: true},
        "account_details[account_number]": {required: true, number: true},
        "account_details[branch_address]": {required: true, name_validate: true},
        "account_details[ac_holder_name]": {required: true, name_validate: true}




      },
       messages: {
        "Temporary[pin_code]": {minlength: "Please enter 6 digits.",maxlength: "Please enter only 6 digits"},
        "Permanent[pin_code]": {minlength: "Please enter 6 digits.",maxlength: "Please enter only 6 digits"},
        "phone[phone_number]": {maxlength: "Please enter only 10 digits"},
        "mobile[phone_number]": {minlength: "Please enter 10 digits.",maxlength: "Please enter only 10 digits"},
        "employee[emergency_contact_number]": {minlength: "Please enter 10 digits.",maxlength: "Please enter only 10 digits"}
          }
    });
});

//==================Dob & Joining date validation starts==========================
     $(document).on("change","#employee_date_of_birth",function(e){
      var joining_date=$("#employee_joining_date").val();
      var dob=$(this).val();
     // alert(getDateObj(dob,dateFormatStr)+3);
     if(getDateObj(dob,dateFormatStr)>getEmployeeJoiningDateObj(joining_date,dateFormatStr)){
        alert("Please check the age");
        document.getElementById('employee_date_of_birth').value ="";
      }

   });
   $(document).on("change","#employee_joining_date",function(e){

      var joining_date=$(this).val();
      var dob=$("#employee_date_of_birth").val();
        if(getDateObj(dob,dateFormatStr)>getEmployeeJoiningDateObj(joining_date,dateFormatStr)){
          alert("Please check the age");
          document.getElementById('employee_joining_date').value ="";
        }
   });
     //======================Dob & Joining date validation ends==============

$(document).on("click", ".delete-operation", function(e){
    var myID =$(this).attr('id');
    
    var splString = myID.split("-");
    var retVal = confirm("Are you sure to delete?");
    if(retVal){
       // alert(retVal);
         var urlLink = "employees/employee_records_delete"

          $.ajax({
            url: urlLink ,
            cache: false,
            data:{"documentID":myID},

            success: function(html){
              alert("SuccessFully Deleted");
              console.log("$(this)");
           
           $("#"+myID).parent().parent().hide();

               

                           
            }
        });





    }else{
       // alert(retVal);     
       return false;
    }
   
});  
function validateEmployeeImage(inputFile, that) {

  if ( that.files && that.files[0]) {
    //alert("inside if");
    var reader = new FileReader();
    reader.onload = imageIsLoaded;
    reader.readAsDataURL(that.files[0]);
  }
  var allowedExtension = ["jpg", "jpeg", "gif", "png"];
  var extName = inputFile.split('.');
  if ($.inArray(extName[1], allowedExtension) == -1){
     window.alert("Only image file with extension: .jpg, .jpeg, .gif or .png is allowed");
     $("#employee_photo").val('');
  }
  else{
    // $("#schoolImageTagID").attr("src","ssc.jpeg.url");

  }
 
} 


function imageIsLoaded(e) {
    $('#employeeImageTagID').attr('src', e.target.result);
};

function employeeCategorySelect(){
    var empCategoryID = $( "#employeeCategorySelectID" ).val();

    $("#maxNoOfClassTextId").prop('readonly', true);
    if(empCategoryID==1) {
      $("#maxNoOfClassTextId").prop('readonly', false);
      //$("#maxNoOfClassTextId").val("0");
    } else {
      $("#maxNoOfClassTextId").val("0");
    }

    if(empCategoryID > 0){
  

           //       alert(empCategoryID); 
   // 'employees/employee_position_list/:id' 

         var urlLink = "/employees/employee_position_list/"+empCategoryID;
         $.ajax({
         //    data : {'mg_employee_category_id':empCategoryID}, 
             url: urlLink,
             cache: false,
             success: function(data){
               // console.log();
                if(data.length > 0){
                    var apdStr = '<option value="">Select</option>';
                   // employeePositionSelectID
                   for(key in data){
                      apdStr += '<option value="'+data[key].id+'">'+data[key].position_name+'</option>'
                    }
                  // console.log(apdStr);
                    $("#employee_mg_employee_position_id").empty().append(apdStr);

                }

             }
                
         });

  }else{
    var apdStr = '<option value="">Choose Category</option>';
    $("#employee_mg_employee_position_id").empty().append(apdStr);
    // alert("Please select category");
  }

    //employeeCategorySelectID
}

// $("#clickFormBtnId").click(function(){
//   var empFirstName=$("#employee_first_name").val().trim();
//   var empLastName=$("#employee_last_name").val().trim();
//   var empDOB=$("#employee_date_of_birth").val().trim();
//   var empFatherName=$("#employee_father_name").val().trim();
//   var empId=$("#currentEmployeeId").val();
//   var urlLink="/employees/verify_employee_record";
  
//   $.ajax({
//         url: urlLink ,
//         dataType: "json",
//         cache: false,
//         data:{
//           empFirstName:  empFirstName,
//           empLastName:   empLastName,
//           empDOB:        empDOB,
//           empFatherName: empFatherName,
//           empId        : empId,
//           varifyEmpRecord: "employee_edit"
//         },
//         success: function(data){
//           console.log("data");
//           console.log(data.empObj);
//           console.log(data.empObj.length);
//           if(data.empObj.length>0){
//             alert("User already exists.");
//           }
//           else if(data.rescue_empObj.length>0){ 
//                 alert(data.rescue_empObj); 
//             } 
//           else{
//             $("#submitEmployeeFormBtnId").click(); 
//           }
//         }
//   });

// });

</script>
<!--   updation ended to make layout  -->


<style>
.mg-capitalize-lbl{
  text-transform: capitalize;
}
#languagePlusId{
  padding: 5px;
  background-color: #2094F6;
  width: 120px;

}

.mytooltip {
cursor: help;
color: green;
border-bottom: 1px dotted green
}

</style>

